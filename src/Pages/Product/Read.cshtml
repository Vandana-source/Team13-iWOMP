@page "{id}"
@using ContosoCrafts.WebSite.Services
@using ContosoCrafts.WebSite.Models
@inject JsonFileProductService ProductService
@model ContosoCrafts.WebSite.Pages.Product.ReadModel

@{
    ViewData["Title"] = "Read page";
}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
<link rel="stylesheet" href="~/css/site.css" />
<link href="https://fonts.googleapis.com/css?family=Yellowtail&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Nunito&display=swap" rel="stylesheet">

<body>
    <a class="font-weight-bold acolor" asp-page="/Explore">Restrooms</a>
    <span class="vertical-bars"></span>
    <a class="font-weight-bold acolor" asp-page="/Explore">Benches</a>
    <span class="vertical-bars"></span>
    <a class="font-weight-bold acolor" asp-page="/Explore">Tables</a>
    <span class="vertical-bars"></span>
    <a class="font-weight-bold acolor" asp-page="/Explore">Other Places</a>
    <br />
    <br />

    <div class="container">
        <div class="text-center">
            <!-- Image Wrapper -->
            <div class="image-wrapper">
                <img class="align-content-center read-img" src='@Model.Product.Image' alt='Image for @Model.Product.Title'>
            </div>
        </div>

        <div class="container2">
            <h5 class="font-weight-bold" id="productTitle">@Model.Product.Title</h5>
            <hr class="horizontal-line"></hr>
            <br />
            <h5 class="font-weight-bold" id="placeNeighborhood">@Model.Product.Neighborhood</h5>
            @{
                int currentRating = 0;
                int voteCount = 0;
                string voteLabel = "";
                if (Model.Product.Ratings == null)
                {
                    currentRating = 0;
                    voteCount = 0;
                }
                else
                {
                    voteCount = Model.Product.Ratings.Count();
                    voteLabel = voteCount > 1 ? "Reviews" : "Review";
                    currentRating = Model.Product.Ratings.Sum() / voteCount;
                }
                System.Console.WriteLine($"Current rating for {Model.Product.Id}: {currentRating}");
                @for (int i = 1; i < 6; i++)
                {
                    var currentStar = i;
                    if (i <= currentRating)
                    {
                        <span class="fa fa-star checked space"></span>
                    }
                    else
                    {
                        <span class="fa fa-star space"></span>
                    }
                }
                @if (voteCount == 0)
                {
                    <span>No Reviews yet!</span>
                }
                else
                {
                    <span>@voteCount @voteLabel</span>
                }
            }
            <br />
            <span class="text-wrapper">D</span>
            <span class="description">
                escription
                <br />@Model.Product.Description
            </span>

            <br /><br />
            <div class="map-container">
                <iframe src="@Model.Product.MapURL" style="border: 0; width: 100%; height: 300px" allowfullscreen></iframe>
            </div>
            <br /><br />

            <div class="row">
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#updateModal">
                    Update
                </button>&nbsp; &nbsp
                <a asp-page="Delete" asp-route-id="@Model.Product.Id" class="btn btn-danger">Delete</a>
            </div>
        </div>
        <br />
    </div>
    <!--<div class="text-center">
        <h5>OTHER PLACES YOU MAY LOVE</h5>
    </div>-->
</body>


<!-- Modal -->
<div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="updateModalLabel">Update</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="titleGroupExampleInput">Title</label>
                        <input type="text" class="form-control" id="titleGroupExampleInput" placeholder="Type a new title">
                    </div>
                    <div class="form-group">
                        <label for="locationTypeFormControlSelect1">Location Type</label>
                        <select class="form-control" id="locationTypeFormControlSelect1">
                            <option>Bench</option>
                            <option>Other</option>
                            <option>Restroom</option>
                            <option>Table</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="descriptionFormControlTextarea1">Description</label>
                        <textarea class="form-control" id="descriptionFormControlTextarea1" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="imageFormControlFile1">Image</label>
                        <input type="file" class="form-control-file" id="imageFormControlFile1">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
</div>
